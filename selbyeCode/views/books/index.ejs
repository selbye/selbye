<% include ../partials/header.ejs %>
    <br>
    <br>
    <!--Main layout-->
    <div class="container-fluid">
        <div class="row">
            <!--Sidebar-->
            <div class="col-lg-2 col-md-2">
                <% if(categories){ %>
                    <% if(categories.length>0){ %>
                        <div class="widget-wrapper">
                            <h4>Categories:</h4>
                            <br>
                            <div class="list-group">
                                <% categories.forEach(function(category){ %>
                                    <a href="/books/?cat=<%= category._id %>" class="list-group-item">
                                        <%= category._id %>
                                    </a>
                                    <% }) %>
                            </div>
                        </div>
                        <% } %>
                            <% } %>
            </div>
            <div class="col-lg-1 col-md-1">

            </div>
            <div class="col-lg-9 col-md-9">
                <% if(books.length>0){ %>
                    <h1 class="text-center"> All books available to buy </h1><br>
                    <% for(var i=0;i<books.length;i++){ %>
                        <% if(i%4 == 0 && i!= 0){ %>
            </div>
            <div class="row">
                <% }else if(i==0){ %>
                    <div class="row text-center">
                        <%  } %>
                            <div class="col-md-3 card-space-top">
                                <div class="card">
                                    <div class="view overlay hm-white-slight">
                                        <img src="<%= books[i].image %>" class="img-responsive" alt="">
                                        <a href="/books/<%= books[i]._id %>">
                                            <div class="mask"></div>
                                        </a>
                                    </div>
                                    <!--/.Card image-->
                                    <!--Card content-->
                                    <div class="card-block">
                                        <!--Title-->
                                        <h4 class="card-title">
                                            <%= books[i].name %>
                                        </h4>
                                        <hr>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <h4> <i class="fa fa-inr"> <%= books[i].price %></i> </h4>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="read-more">
                                                    <a href="/books/<%= books[i]._id %>" class="btn btn-success">View</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--/.Card content-->
                                </div>
                            </div>
                            <% } %>
                                <% }else{ %>
                                    <h3 class="red-text">Sorry There are currently No books available under this category. Please Add new book
                                        if you want to sell.
                                    </h3>
                                    
                                    <% } %>
                    </div>
                    <!--pagination-->
 <br><br>
 <% if(totalBooks>0){ %>
  <% var pagesVar = totalBooks/12 %>
 <% pages = parseInt(pagesVar+1) %>
 <% if(!page){ %>
  <%  page == 1 %>
  <% } %>
<nav>
  <ul class="pagination">
<% for(var i = 1; i<= pages;i+=1){ %>
  <% if(currentCategory){ %>
<% if(!page){ page = 1 } %>
<% if(page == i){ %>
<li class="page-item active">
   <a class="page-link" href="/books?cat=<%= currentCategory %>&page=<%= i %>">
       <%= i %>
   </a>
         </li>
         <% }else{ %>
   <li class="page-item">
       <a class="page-link" href="/books?cat=<%= currentCategory %>&page=<%= i %>">
           <%= i %>
                     </a>
      </li>
                           <% } %>
                <% }else{ %>
                <% if(query){ %>
                <% if(!page){ page = 1 } %>
                        <% if(page == i){ %>
  <li class="page-item active">
      <a class="page-link" href="/books?page=<%= i %>&q=<%= query %>">
          <%= i %>
      </a>
  </li>
  <% }else{ %>
      <li class="page-item">
          <a class="page-link" href="/books?page=<%= i %>&q=<%= query %>">
              <%= i %>
          </a>
      </li>
 <% } %>

<% }else{ %>
                    <% if(!page){ page = 1 } %>
                        <% if(page == i){ %>
  <li class="page-item active">
      <a class="page-link" href="/books?page=<%= i %>">
          <%= i %>
      </a>
  </li>
  <% }else{ %>
      <li class="page-item">
          <a class="page-link" href="/books?page=<%= i %>">
              <%= i %>
          </a>
      </li>
 <% } %>
 <% } %>

<% } %>
 <% } %>
 </ul>
</nav>
 <% } %>
  <!--/pagination-->
            </div>
        </div>
    </div>

    <% include ../partials/footer %>
